---
title: 引用块
icon: Brackets
---

## 功能概述

引用块是Project Graph中的双链功能核心组件，它允许用户在当前项目中引用其他.prg文件的内容，并以静态图片形式展示。通过引用块，用户可以建立不同文件间的知识关联，实现高效的知识管理和快速导航。

## 双链使用方法

### 创建引用块（建立双链）

1. 双击创建一个文本节点
2. 在文本节点中输入双中括号语法：
   - 引用整个文件格式：`[[文件名]]`（文件名不需要包含.prg扩展名）
   - 引用特定Section格式：`[[文件名#Section框标题名称]]`（必须包含有效的Section名称）
   - 尽量确保不要引用存在有重复的文件名、和Section框标题名称
3. 文本节点退出编辑状态后，将自动验证并将文本节点转换为引用块
   - 请确保该文本节点没有指向它的连线。因为目前当有连线连向此文本节点时，退出编辑状态后连线会指向虚空且无法斩断删除，可以通过ctrl+拖拽连线改变指向的实体，改变指向后再删除连线即可
4. 转换成功后，引用块将显示被引用内容的静态截图

### 引用块基本操作

- **移动**：直接拖拽引用块到舞台上的任意位置
- **缩放**：使用Ctrl+鼠标滚轮或缩放工具调整引用块大小
- **跳转**：点击引用块，系统将自动打开源文件并定位到被引用的内容
- **刷新**：右键点击引用块，选择"刷新引用"更新内容
- **删除**：选中引用块后按Delete键或通过右键菜单删除
- **复制**：选中引用块后按Ctrl+C复制引用内容
- **改变引用**：目前不支持，可以直接砍掉此引用块重新创建一个。（创建引用块的代价很低）

## 双链刷新机制

### 手动刷新

引用块目前不会自动更新内容，需要手动刷新以同步源文件的最新状态：

1. 右键点击引用块
2. 选择"刷新引用"选项
3. 系统将重新生成截图并更新显示

### 引用管理器刷新

在引用管理器中也可以刷新所有引用信息：

1. 点击菜单栏"视图 > 引用管理器"
2. 在引用管理器窗口中点击"刷新"按钮
3. 系统将重新扫描并更新所有引用关系

## 双链关联原理

### 引用关系建立

引用块通过以下方式建立与源文件的关联：

- **文件名匹配**：引用块存储目标文件的名称（不包含扩展名）
- **Section名称**：如果引用特定Section，则同时存储Section名称
- **附件存储**：引用内容以静态图片形式保存为项目附件

### 双链查找机制

当引用块需要刷新或跳转时，系统会：

1. **文件查找**：首先在最近文件列表中查找匹配的文件名
2. **Section定位**：如果引用了特定Section，则在目标文件中搜索对应的Section框
3. **验证连接**：确认文件和Section存在后，建立有效的引用连接
4. **生成新截图**：连接成功后，生成最新内容的截图

## 连接断裂与维护

### 可能导致连接断裂的操作

以下操作可能导致引用块与源文件的连接断裂：

- **重命名源文件**：修改被引用文件的文件名
- **移动源文件位置**：将文件移动到其他目录（但打开一次移动后的文件就能立刻自动更新“最近打开列表”并自动恢复）
- **重命名或删除Section**：修改或移除被引用的Section框名称（若删除后再重新加回来，中途没有去手动更新引用，就没事）
- **清理最近文件列表**：清除包含目标文件的最近文件记录

### 不会导致连接断裂的操作

以下操作不会影响引用块的连接状态：

- **修改源文件内容**：更新文件中的文本、图形等内容
- **调整源文件中被引用的Section的位置**：移动Section框在舞台上的位置
- **更改源文件中被引用的Section的样式**：调整Section框的颜色、边框等视觉属性
- **在源文件中被引用的那个Section内外新增内容**：在引用的Section框内新增节点、连接等内容，或者在外部新包一个Section框、连接各种连线等等
- **在源文件中添加新内容**：增加新的节点、连接等

### 连接断裂后的修复

断裂后由于截图附件文件存在的原因，不会立刻看到“notFound”情况，如果刷新后引用块显示"notFound"状态，表示连接已断裂，可以尝试：

2. **检查文件名**：确认源文件名是否正确，包括大小写，空格等符号
3. **重新打开源文件**：确保目标文件在最近文件列表中，如果不确定，可以打开数据文件夹中的“recentFiles.json”
4. **重建引用**：如果以上方法无效，可以删除旧引用块并创建新的引用，（反正创建引用块的操作是很快的）

## 引用管理器使用

引用管理器提供了查看和管理所有引用关系的功能：

1. **打开方式**：点击菜单栏"视图 > 引用管理器"
2. **查看引用关系**：
   - 查看哪些文件直接引用了当前文件
   - 查看哪些文件引用了当前文件中的特定Section
3. **快速跳转**：点击列表项可直接跳转到对应的引用位置
4. **刷新引用信息**：点击"刷新"按钮更新所有引用关系数据

## 引用块使用建议

### 有效使用提示

- **保持文件名稳定**：避免频繁重命名文件，以免引用连接断裂
- **使用有意义的Section名称**：为重要内容创建明确命名的Section，便于引用
- **定期刷新重要引用**：对于关键引用，定期手动刷新以确保内容最新
- **避免重复的名称**：Section名和文件名尽量避免重复，以确保引用的准确性和唯一性

### 避免的操作

- 不要引用临时或频繁变化的文件
- 避免引用过于庞大的文件，由于防止卡顿，直接引用面积庞大的文件时截图的大小会被限制在一个固定值内，默认最大边长是1920px，所以可能过于细节的内容看不清楚，建议配合井号引用必要的Section内容，分块创建多个引用
- 不要在短时间内频繁批量刷新大量引用块

通过合理使用引用块功能，您可以在Project Graph中构建高效的知识网络，实现不同文件间的智能关联和快速导航，显著提升知识管理和项目规划的效率。
